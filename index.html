<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#be123c">
    <title>Riviera Francesa - Nossa Experiência</title>
    
    <!-- Frameworks -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap');
        
        /* Design System */
        body { font-family: 'Lato', sans-serif; background-color: #f8fafc; color: #1e293b; padding-bottom: 100px; }
        h1, h2, h3, h4, .serif-font { font-family: 'Playfair Display', serif; }
        
        /* Mobile Nav */
        .nav-scroll { -ms-overflow-style: none; scrollbar-width: none; white-space: nowrap; overflow-x: auto; }
        .nav-scroll::-webkit-scrollbar { display: none; }
        
        .tab-button {
            display: inline-flex; align-items: center; padding: 0.8rem 1.2rem;
            font-weight: 600; color: #64748b; border-bottom: 3px solid transparent;
            transition: all 0.3s ease; font-size: 0.9rem;
        }
        .tab-button.active { color: #be123c; border-bottom-color: #be123c; background-color: #fff1f2; }
        
        .tab-content { display: none; animation: fadeIn 0.4s ease-out; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

        /* Cards */
        .card-zoom { overflow: hidden; }
        .card-zoom img { transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); width: 100%; height: 100%; object-fit: cover; }
        .card-zoom:hover img { transform: scale(1.08); }
        
        /* Vote Bar */
        .vote-bar { transition: width 1.5s ease-in-out; }
        .vote-btn.selected { background-color: #10b981; border-color: #10b981; color: white; cursor: default; pointer-events: none; }
        .vote-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Chat Widget */
        .chat-window { 
            position: fixed; bottom: 90px; right: 20px; width: 90vw; max-width: 360px; height: 550px; max-height: 70vh;
            background: white; border-radius: 24px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); 
            display: flex; flex-direction: column; z-index: 5000; border: 1px solid #e2e8f0;
            transform: scale(0) translateY(20px); opacity: 0; transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); pointer-events: none;
        }
        .chat-window.open { transform: scale(1) translateY(0); opacity: 1; pointer-events: all; }
        .chat-btn {
            position: fixed; bottom: 20px; right: 20px; width: 64px; height: 64px; border-radius: 50%;
            background: linear-gradient(135deg, #be123c, #f43f5e); color: white;
            display: flex; align-items: center; justify-content: center; font-size: 26px;
            box-shadow: 0 10px 25px -5px rgba(190, 18, 60, 0.5); cursor: pointer; z-index: 5000;
            transition: transform 0.2s;
        }
        .chat-btn:hover { transform: scale(1.1); }

        /* AI Loader */
        .typing-indicator span {
            display: inline-block; width: 6px; height: 6px; background-color: #be123c; border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out both; margin: 0 2px;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    </style>
</head>
<body>

    <header class="bg-white border-b border-slate-200 sticky top-0 z-40 shadow-sm/50">
        <div class="container mx-auto px-4 py-5 text-center">
            <div class="inline-block bg-rose-50 border border-rose-100 px-3 py-1 rounded-full mb-2">
                <p class="text-[10px] font-bold text-rose-600 uppercase tracking-widest">29 Maio – 13 Junho 2026</p>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900 serif-font tracking-tight">Riviera Francesa</h1>
            <p class="text-sm text-slate-500 font-light italic mt-1">Nossa Experiência Exclusiva</p>
        </div>
        
        <div class="w-full overflow-x-auto nav-scroll bg-white/95 backdrop-blur border-t border-slate-50">
            <div class="flex px-2 min-w-max md:justify-center gap-1">
                <button class="tab-button active" data-tab="overview"><i class="fa-solid fa-compass"></i>Visão Geral</button>
                <button class="tab-button" data-tab="itinerary"><i class="fa-regular fa-calendar-days"></i>Roteiro</button>
                <button class="tab-button" data-tab="gastronomy"><i class="fa-solid fa-utensils"></i>Sabores & IA</button>
                <button class="tab-button" data-tab="hotels"><i class="fa-solid fa-bed"></i>Hotéis</button>
                <button class="tab-button" data-tab="logistics"><i class="fa-solid fa-suitcase-rolling"></i>Logística</button>
                <button class="tab-button" data-tab="highlights"><i class="fa-solid fa-camera-retro"></i>Galeria</button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-5xl">

        <!-- 1. VISÃO GERAL -->
        <section id="overview" class="tab-content active">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 text-center">
                    <div class="text-3xl font-bold text-rose-700 serif-font">16</div>
                    <div class="text-[10px] uppercase tracking-wider text-slate-400 font-bold mt-1">Dias</div>
                </div>
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 text-center">
                    <div class="text-3xl font-bold text-rose-700 serif-font">5</div>
                    <div class="text-[10px] uppercase tracking-wider text-slate-400 font-bold mt-1">Bases</div>
                </div>
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 text-center">
                    <div class="text-3xl font-bold text-rose-700 serif-font">3</div>
                    <div class="text-[10px] uppercase tracking-wider text-slate-400 font-bold mt-1">Regiões</div>
                </div>
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 text-center">
                    <div class="text-3xl font-bold text-rose-700 serif-font">∞</div>
                    <div class="text-[10px] uppercase tracking-wider text-slate-400 font-bold mt-1">Memórias</div>
                </div>
            </div>

            <div class="bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-xl mb-10 flex items-start gap-4 shadow-sm">
                <div class="bg-amber-100 p-2 rounded-full text-amber-600"><i class="fa-solid fa-check-to-slot"></i></div>
                <div>
                    <h3 class="font-bold text-amber-900 text-sm uppercase tracking-wide mb-1">Votação em Andamento</h3>
                    <p class="text-xs text-amber-700 leading-relaxed">Vote nas opções de <strong>Avignon</strong>, <strong>Aix</strong>, <strong>Marseille</strong> e <strong>Nice</strong>. Acompanhe o totalizador na aba <strong>Hotéis</strong>.</p>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <h3 class="text-lg font-bold text-slate-800 mb-6 serif-font flex items-center gap-2"><i class="fa-solid fa-route text-rose-500"></i> Jornada Resumida</h3>
                    <div class="space-y-8 border-l-2 border-slate-100 pl-6 ml-2 relative">
                        <div class="relative">
                            <div class="absolute -left-[33px] top-1 w-5 h-5 bg-blue-600 rounded-full border-4 border-white shadow-sm"></div>
                            <h4 class="font-bold text-slate-900 text-sm">Paris</h4>
                            <p class="text-xs text-slate-500 mt-1">29/05 - 30/05 • Chegada & TGV</p>
                        </div>
                        <div class="relative">
                            <div class="absolute -left-[33px] top-1 w-5 h-5 bg-purple-600 rounded-full border-4 border-white shadow-sm"></div>
                            <h4 class="font-bold text-slate-900 text-sm">Provence</h4>
                            <p class="text-xs text-slate-500 mt-1">30/05 - 06/06 • Avignon, Aix, Marseille</p>
                        </div>
                        <div class="relative">
                            <div class="absolute -left-[33px] top-1 w-5 h-5 bg-teal-500 rounded-full border-4 border-white shadow-sm"></div>
                            <h4 class="font-bold text-slate-900 text-sm">Riviera & Nice</h4>
                            <p class="text-xs text-slate-500 mt-1">06/06 - 13/06 • Costa Azul & Retorno</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col justify-center">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 serif-font text-center">Foco da Viagem</h3>
                    <div class="relative w-full h-48">
                        <canvas id="themeChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- 2. ROTEIRO -->
        <section id="itinerary" class="tab-content">
            <div class="text-center mb-8">
                <p class="text-xs text-slate-400 uppercase tracking-widest font-bold">Detalhes Dia a Dia</p>
            </div>
            <div id="accordion-container" class="space-y-4 max-w-3xl mx-auto"></div>
        </section>

        <!-- 3. GASTRONOMIA -->
        <section id="gastronomy" class="tab-content">
            <div class="bg-white rounded-2xl shadow-lg shadow-rose-100/50 border border-rose-100 p-6 mb-10 relative overflow-hidden">
                <h3 class="text-base font-bold text-slate-800 mb-2 flex items-center gap-2 relative z-10">
                    <i class="fa-solid fa-hat-chef text-rose-500"></i> Chef Sommelier IA
                </h3>
                <p class="text-xs text-slate-500 mb-4 relative z-10">Digite o nome de um prato (ex: <em>Cassoulet</em>) para análise profunda.</p>
                <div class="flex gap-2 relative z-10">
                    <input type="text" id="menuInput" placeholder="Prato francês..." class="flex-1 px-4 py-3 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-rose-500 transition-shadow">
                    <button id="decodeMenuBtn" class="bg-rose-600 text-white px-5 py-3 rounded-xl font-bold text-sm hover:bg-rose-700 transition-colors shadow-md shadow-rose-200">Consultar</button>
                </div>
                <div id="menuResult" class="mt-4 hidden text-sm bg-slate-50 p-4 rounded-xl text-slate-700 border border-slate-100 shadow-inner leading-relaxed"></div>
            </div>
            <div id="gastronomy-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </section>

        <!-- 4. HOTÉIS -->
        <section id="hotels" class="tab-content">
            <div class="flex justify-between items-end mb-8 px-2">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900 serif-font">Hotelaria</h2>
                    <p class="text-xs text-slate-500 mt-1">Cotação oficial e Votação ativa.</p>
                </div>
                <div id="poll-status" class="px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide shadow-sm"></div>
            </div>
            <div id="hotels-container" class="space-y-12"></div>
        </section>

        <!-- 5. LOGÍSTICA -->
        <section id="logistics" class="tab-content">
            <div class="bg-slate-800 rounded-2xl p-6 mb-8 text-white shadow-xl relative overflow-hidden">
                <h3 class="text-base font-bold mb-2 flex items-center gap-2 relative z-10">
                    <i class="fa-solid fa-shirt text-blue-300"></i> Personal Stylist IA
                </h3>
                <p class="text-xs text-slate-300 mb-3 relative z-10">Descreva seu perfil para uma mala sob medida.</p>
                <div class="flex flex-col gap-3 relative z-10">
                    <input type="text" id="packingProfile" placeholder="Ex: Mulher, friorenta, gosto de saltos..." class="w-full px-4 py-2.5 rounded-lg text-sm text-slate-800 focus:outline-none">
                    <button id="generatePackingBtn" class="w-full py-3 bg-white/10 hover:bg-white/20 rounded-xl font-bold text-sm transition-all border border-white/10 flex items-center justify-center gap-2 backdrop-blur-sm">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> Gerar Mala
                    </button>
                </div>
                <div id="packingResult" class="mt-5 hidden text-xs text-slate-200 bg-black/20 p-5 rounded-xl leading-relaxed whitespace-pre-line border border-white/5"></div>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100">
                <h3 class="font-bold text-slate-700 text-sm mb-4 ml-1"><i class="fa-solid fa-map text-slate-400 mr-2"></i>Mapa da Região</h3>
                <div class="w-full h-72 bg-slate-100 rounded-xl overflow-hidden relative shadow-inner">
                    <iframe width="100%" height="100%" frameborder="0" style="border:0" src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d1458377.657456324!2d5.9311119!3d43.529742!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sfr!4v1620000000000!5m2!1sen!2sfr" loading="lazy"></iframe>
                </div>
            </div>
        </section>

        <!-- 6. GALERIA -->
        <section id="highlights" class="tab-content">
            <div id="gallery-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
        </section>

    </main>

    <!-- Chat Widget -->
    <div class="chat-window" id="chatWindow">
        <div class="bg-rose-600 p-4 flex justify-between items-center text-white rounded-t-3xl shadow-md">
            <div class="font-bold flex items-center gap-2 text-sm"><i class="fa-solid fa-robot"></i> Concierge IA</div>
            <button id="closeChat" class="hover:bg-white/20 w-8 h-8 rounded-full transition-colors flex items-center justify-center"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="flex-1 p-4 overflow-y-auto bg-slate-50 flex flex-col gap-3" id="chatMessages">
            <div class="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-xs self-start max-w-[85%] text-slate-600 leading-relaxed">
                Bonjour! Sou seu assistente virtual. Posso ajudar com detalhes do roteiro, previsão do tempo, ou traduzir frases para francês.
            </div>
        </div>
        <div class="p-3 bg-white border-t border-slate-100 flex gap-2 rounded-b-3xl">
            <input type="text" id="chatInput" placeholder="Digite sua dúvida..." class="flex-1 px-4 py-2 border border-slate-200 rounded-full text-sm focus:outline-none focus:border-rose-500 transition-colors bg-slate-50">
            <button id="sendMessage" class="w-10 h-10 bg-rose-600 text-white rounded-full flex items-center justify-center shadow-lg shadow-rose-200 active:scale-95 transition-transform"><i class="fa-solid fa-paper-plane text-xs"></i></button>
        </div>
    </div>
    <div class="chat-btn" id="toggleChat"><i class="fa-regular fa-comment-dots"></i></div>

    <script>
        // 1. CONFIGURAÇÃO
        const API_KEY = "AIzaSyCB2zNVCasr1B3FAJAMvJ4GuXtbeFZsmz8"; 
        const POLL_DEADLINE = new Date('2025-12-01T23:59:59');

        // 2. DADOS (Completos do Word e Planilha)
        const itinerary = [
            { 
                day: 1, date: "29/05", title: "Paris: Chegada, Montmartre & Torre Eiffel", 
                morning: "Chegada a Paris. Traslado privativo ao <strong>Hotel Le Meurice</strong>. Início em <strong>Montmartre</strong>: Visita à <em>Basílica de Sacré-Cœur</em> com vista panorâmica e caminhada pela <em>Place du Tertre</em>, observando os artistas de rua que mantêm viva a tradição boêmia de Picasso e Dalí.", 
                afternoon: "Imersão no <strong>Musée d’Orsay</strong> (antiga estação de trem Belle Époque) para ver os mestres Impressionistas como Monet e Van Gogh. Passeio relaxante pelo Jardim das Tulherias até a Place de la Concorde.", 
                evening: "Momento mágico: Torre Eiffel iluminada e jantar gastronômico reservado no <strong>Le Jules Verne</strong> (2º andar), com menu degustação do chef Frédéric Anton e vista inesquecível.", 
                context: "Eiffel Tower view from Le Jules Verne restaurant luxury", loc: "Le Jules Verne" 
            },
            { 
                day: 2, date: "30/05", title: "Paris → Avignon (TGV)", 
                morning: "Manhã livre no Marais, visitando a histórica <em>Place des Vosges</em> e suas galerias. Almoço emblemático no <strong>Le Train Bleu</strong> (Gare de Lyon), um monumento da Belle Époque.", 
                afternoon: "Viagem de TGV para Avignon (2h40). Check-in no Hotel La Mirande ou d'Europe.", 
                evening: "Primeiro contato com a Provence: Passeio pela <em>Place de l’Horloge</em> e contemplação do Palais des Papes iluminado à noite.", 
                context: "Le Train Bleu restaurant Paris interior gold", loc: "Le Train Bleu" 
            },
            { 
                day: 3, date: "31/05", title: "Avignon: A Cidade dos Papas", 
                morning: "Visita guiada ao imponente <strong>Palais des Papes</strong> (maior palácio gótico da Europa) e Jardim do Rocher des Doms para ver a famosa <em>Pont d'Avignon</em> sobre o Ródano.", 
                afternoon: "Passeio na pitoresca <em>Rue des Teinturiers</em> com suas rodas d'água e canais. Degustação exclusiva de vinhos <strong>Châteauneuf-du-Pape</strong> em cave local.", 
                evening: "Jantar refinado no restaurante <em>Christian Étienne</em> ou no ambiente intimista do La Mirande.", 
                context: "Palais des Papes Avignon exterior sunny", loc: "Palais des Papes" 
            },
            { 
                day: 4, date: "01/06", title: "Luberon: Vilarejos e Ocre", 
                morning: "Rota do 'Ouro Azul': Museu da Lavanda em Coustellet, seguido de visita a <strong>Gordes</strong> (um dos vilarejos mais belos da França) e parada no mirante da <em>Abbaye de Sénanque</em>.", 
                afternoon: "Caminhada pelo surreal 'Sentier des Ocres' em <strong>Roussillon</strong> (o Colorado Provençal). Visita a Ménerbes, cenário do livro 'Um Ano na Provence'.", 
                evening: "Retorno a Avignon. Jantar em bistrô local (sugestão: <em>L’Agape</em>).", 
                context: "Gordes village Provence panoramic view", loc: "Gordes" 
            },
            { 
                day: 5, date: "02/06", title: "Avignon → Aix-en-Provence", 
                morning: "Visita à impressionante <strong>Pont du Gard</strong> (Aqueduto Romano milenar) e ao vilarejo fortificado de <strong>Les Baux-de-Provence</strong>.", 
                afternoon: "Espetáculo de arte imersiva nas <strong>Carrières de Lumières</strong> (antiga pedreira com projeções gigantes). Breve parada em St-Rémy (Van Gogh). Chegada em Aix.", 
                evening: "Caminhada pelo elegante <em>Cours Mirabeau</em> e jantar no histórico café <strong>Les Deux Garçons</strong>, frequentado por Cézanne e Zola.", 
                context: "Carrieres de Lumieres art exhibition van gogh", loc: "Carrières de Lumières" 
            },
            { 
                day: 6, date: "03/06", title: "Aix: Cassis & Calanques", 
                morning: "Bate-volta à costa. Passeio de barco para explorar as <strong>Calanques de Cassis</strong> (fiordes de calcário branco e água turquesa).", 
                afternoon: "Almoço de frutos do mar no porto de Cassis. Visita ao vilarejo medieval de <strong>Le Castellet</strong> e degustação de vinhos tintos potentes de Bandol (Mourvèdre).", 
                evening: "Noite livre para explorar o charme do centro histórico de Aix (Quartier Mazarin).", 
                context: "Calanques de Cassis turquoise water boat", loc: "Cassis" 
            },
            { 
                day: 7, date: "04/06", title: "Aix → Marseille", 
                morning: "Ida ao <strong>Platô de Valensole</strong> para ver os campos de lavanda (início da floração) e visita à fábrica da <strong>L’Occitane</strong> em Manosque.", 
                afternoon: "Chegada em Marseille (InterContinental/Sofitel). Subida à Basílica Notre-Dame de la Garde para vista 360º.", 
                evening: "Jantar clássico: A autêntica <em>Bouillabaisse</em> no <strong>Chez Fonfon</strong>, no porto pitoresco de Vallon des Auffes.", 
                context: "Valensole lavender fields sunset purple", loc: "Chez Fonfon" 
            },
            { 
                day: 8, date: "05/06", title: "Marseille: História & Mar", 
                morning: "Exploração do <strong>Vieux Port</strong>, mercado de peixes e o bairro artístico de <em>Le Panier</em> (Vieille Charité).", 
                afternoon: "Cultura no MuCEM e passeio de barco até o lendário <strong>Château d’If</strong>, prisão do Conde de Monte Cristo.", 
                evening: "Jantar no vibrante bairro Cours Julien ou frutos do mar no <em>Le Miramar</em>.", 
                context: "Marseille Vieux Port boats sunny", loc: "Vieux Port Marseille" 
            },
            { 
                day: 9, date: "06/06", title: "Marseille → Nice (Via St-Tropez)", 
                morning: "Parada no glamour de <strong>Saint-Tropez</strong>: Passeio pelo porto, café no Sénéquier e visita à Citadelle.", 
                afternoon: "Prova da famosa <em>Tarte Tropézienne</em>. Viagem pela estrada costeira até Nice. Check-in no icônico <strong>Hotel Le Negresco</strong>.", 
                evening: "Caminhada na Promenade des Anglais e jantar no <strong>Le Chantecler</strong> (dentro do Negresco).", 
                context: "Saint Tropez harbor luxury yachts summer", loc: "Saint-Tropez" 
            },
            { 
                day: 10, date: "07/06", title: "Arte na Riviera", 
                morning: "Visita a Vence e à emocionante <strong>Capela do Rosário</strong>, obra-prima de Matisse.", 
                afternoon: "<strong>Saint-Paul-de-Vence</strong>: Galerias de arte, Fundação Maeght e almoço no lendário <strong>La Colombe d’Or</strong> (onde Picasso pagava com obras).", 
                evening: "Retorno a Nice. Jantar no animado Cours Saleya.", 
                context: "Saint Paul de Vence cobblestone streets art", loc: "Saint-Paul-de-Vence" 
            },
            { 
                day: 11, date: "08/06", title: "Antibes & Cannes", 
                morning: "Trem para Antibes: Mercado Provençal e <strong>Museu Picasso</strong> no Castelo Grimaldi.", 
                afternoon: "<strong>Cannes</strong>: Caminhada pela La Croisette, hotéis de luxo e foto no tapete vermelho do Palácio dos Festivais.", 
                evening: "Jantar na área gastronômica do Porto Lympia em Nice.", 
                context: "Cannes La Croisette palm trees luxury", loc: "Cannes" 
            },
            { 
                day: 12, date: "09/06", title: "A Alma de Nice", 
                morning: "Imersão local: Mercado das Flores, ruelas de Vieux Nice e Catedral Sainte-Réparate.", 
                afternoon: "Bairro de Cimiez: Museus Matisse e Marc Chagall, além das Ruínas Romanas.", 
                evening: "Jantar típico 'Nissarde' (ex: <em>Chez Acchiardo</em>) e subida à Colline du Château para vista noturna.", 
                context: "Nice Old Town colorful buildings narrow streets", loc: "Vieux Nice" 
            },
            { 
                day: 13, date: "10/06", title: "Mônaco & Èze", 
                morning: "Bate-volta ao Principado: <strong>Cassino de Monte-Carlo</strong>, Palácio do Príncipe e parada no vilarejo suspenso de <strong>Èze</strong>.", 
                afternoon: "Tarde livre: Relaxar em uma praia privada em Nice ou compras na Av. Jean Médecin.", 
                evening: "Despedida nos bares de vinho do centro antigo.", 
                context: "Monaco Monte Carlo Casino exterior luxury cars", loc: "Casino de Monte-Carlo" 
            },
            { 
                day: 14, date: "11/06", title: "Despedida da Riviera", 
                morning: "Experiência: Aula de Culinária Niçoise ou Piquenique gourmet.", 
                afternoon: "Visita ao Parc Phoenix ou tempo livre para últimas lembranças.", 
                evening: "Grand Finale: Jantar no <strong>Le Plongeoir</strong>, restaurante situado sobre uma rocha no mar.", 
                context: "Le Plongeoir restaurant Nice sea view", loc: "Le Plongeoir" 
            },
            { 
                day: 15, date: "12/06", title: "Nice → Paris", 
                morning: "Manhã livre (sugestão: visita rápida a Menton, cidade dos limões).", 
                afternoon: "Traslado ao aeroporto de Nice. Voo para Paris (CDG). Pernoite em hotel próximo ao aeroporto.", 
                evening: "Jantar tranquilo e descanso para o voo internacional.", 
                context: "Menton France lemon festival colorful", loc: "Menton" 
            },
            { 
                day: 16, date: "13/06", title: "Retorno ao Brasil", 
                morning: "Traslado curto para o terminal no CDG. Check-in.", 
                afternoon: "Embarque no voo Air France (13:20). Voo diurno.", 
                evening: "Chegada em Fortaleza prevista para 17:35. Fim da viagem.", 
                context: "Air France plane sky clouds", loc: "Charles de Gaulle Airport" 
            }
        ];

        // Hotéis - ATUALIZADO PARA INCLUIR MÚLTIPLAS OPÇÕES EM MARSEILLE E NICE
        const hotels = {
            "Paris": [{ name: "Meilá Paris", stars: "4★", dates: "30/05-31/05", price: "R$ 1.452", desc: "Localização estratégica.", img: "Melia Paris Hotel facade" }],
            "Avignon": [
                { name: "La Mirande", stars: "5★", dates: "31/05-03/06", price: "R$ 12.699", desc: "Histórico, luxo supremo.", img: "La Mirande Avignon interior" },
                { name: "Hôtel d’Europe", stars: "5★", dates: "31/05-03/06", price: "R$ 6.794", desc: "Clássico e elegante.", img: "Hotel d Europe Avignon courtyard" }
            ],
            "Aix-en-Provence": [
                { name: "Hôtel Le Pigonnet", stars: "5★", dates: "03/06-05/06", price: "R$ 6.174", desc: "Jardins de Cézanne.", img: "Hotel Le Pigonnet Aix garden" },
                { name: "Villa Gallici", stars: "5★", dates: "03/06-05/06", price: "R$ 12.647", desc: "Relais & Châteaux.", img: "Villa Gallici Aix Hotel pool" },
                { name: "Renaissance", stars: "4★", dates: "03/06-05/06", price: "R$ 4.971", desc: "Moderno.", img: "Renaissance Aix Hotel exterior" }
            ],
            "Marseille": [
                { name: "InterContinental Hôtel Dieu", stars: "5★", dates: "05/06-07/06", price: "R$ 7.800", desc: "Vista icônica para Notre-Dame.", img: "InterContinental Marseille Hotel Dieu" },
                { name: "Sofitel Vieux Port", stars: "5★", dates: "05/06-07/06", price: "R$ 5.200", desc: "Melhor vista do Porto Velho.", img: "Sofitel Marseille Vieux Port view" }
            ],
            "Nice": [
                { name: "Hotel Le Negresco", stars: "5★", dates: "07/06-12/06", price: "R$ 20.000", desc: "O ícone da Riviera.", img: "Hotel Negresco Nice exterior" },
                { name: "Anantara Plaza Nice", stars: "5★", dates: "07/06-12/06", price: "R$ 15.000", desc: "Luxo moderno e rooftop.", img: "Anantara Plaza Nice Hotel" }
            ]
        };

        const gastronomy = [
            { title: "Le Jules Verne", loc: "Paris", desc: "Jantar 1★ Michelin na Torre Eiffel.", img: "Jules Verne Restaurant Paris view" },
            { title: "Le Train Bleu", loc: "Paris", desc: "Almoço em monumento histórico.", img: "Le Train Bleu Restaurant interior" },
            { title: "Chez Fonfon", loc: "Marseille", desc: "A autêntica Bouillabaisse.", img: "Bouillabaisse Marseille dish" },
            { title: "La Colombe d'Or", loc: "St-Paul", desc: "Onde Picasso comia.", img: "Colombe d Or Saint Paul de Vence art" },
            { title: "Le Chantecler", loc: "Nice", desc: "Alta gastronomia no Negresco.", img: "Le Chantecler Restaurant Nice table" },
            { title: "Le Plongeoir", loc: "Nice", desc: "Jantar sobre o mar.", img: "Le Plongeoir Nice sunset" }
        ];

        // 3. LÓGICA
        const tabs = document.querySelectorAll('.tab-button');
        const contents = document.querySelectorAll('.tab-content');
        tabs.forEach(btn => {
            btn.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                contents.forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab).classList.add('active');
            });
        });

        // RENDER
        const accContainer = document.getElementById('accordion-container');
        itinerary.forEach(item => {
            const imgUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(item.context)}%20cinematic%20lighting%204k?width=800&height=400&nologo=true`;
            accContainer.innerHTML += `
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden group">
                    <div class="p-4 flex justify-between items-center cursor-pointer active:bg-slate-50 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden')">
                        <div class="flex items-center gap-4">
                            <div class="bg-rose-50 text-rose-700 text-xs font-bold px-2 py-1 rounded-lg border border-rose-100 text-center min-w-[55px]">
                                ${item.day}<br><span class="text-[9px] text-slate-400 opacity-80 font-normal">${item.date}</span>
                            </div>
                            <div>
                                <h4 class="font-bold text-slate-800 text-sm md:text-base leading-tight">${item.title}</h4>
                                <a href="https://www.google.com/maps/search/?api=1&query=${item.loc}" target="_blank" class="text-[10px] text-blue-500 font-bold flex items-center gap-1 mt-1 hover:text-blue-700 transition-colors" onclick="event.stopPropagation()">
                                    <i class="fa-solid fa-location-dot"></i> Ver Localização
                                </a>
                            </div>
                        </div>
                        <i class="fa-solid fa-chevron-down text-slate-300 text-xs"></i>
                    </div>
                    <div class="hidden border-t border-slate-50 bg-slate-50/30">
                        <div class="h-32 overflow-hidden relative">
                            <img src="${imgUrl}" loading="lazy" class="w-full h-full object-cover opacity-95">
                            <div class="absolute bottom-0 left-0 w-full h-10 bg-gradient-to-t from-black/60 to-transparent"></div>
                        </div>
                        <div class="p-5 text-sm text-slate-600 space-y-3 leading-relaxed">
                            <div class="flex gap-2"><span class="text-rose-700 font-bold text-[10px] uppercase w-12 shrink-0 pt-0.5">Manhã</span> <span>${item.morning}</span></div>
                            <div class="flex gap-2"><span class="text-rose-700 font-bold text-[10px] uppercase w-12 shrink-0 pt-0.5">Tarde</span> <span>${item.afternoon}</span></div>
                            <div class="flex gap-2"><span class="text-indigo-900 font-bold text-[10px] uppercase w-12 shrink-0 pt-0.5">Noite</span> <span>${item.evening}</span></div>
                        </div>
                    </div>
                </div>
            `;
        });

        const hotelContainer = document.getElementById('hotels-container');
        const isPollOpen = new Date() <= POLL_DEADLINE;
        const pollStatus = document.getElementById('poll-status');
        pollStatus.textContent = isPollOpen ? "Votação Aberta" : "Encerrada";
        pollStatus.className = isPollOpen ? "px-3 py-1 bg-green-100 text-green-700 rounded-full text-[10px] font-bold uppercase tracking-wider" : "px-3 py-1 bg-red-100 text-red-700 rounded-full text-[10px] font-bold uppercase tracking-wider";

        for (const [city, list] of Object.entries(hotels)) {
            const isPoll = list.length > 1;
            let html = `
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
                    <div class="flex justify-between items-center mb-5">
                        <h3 class="text-lg font-bold text-slate-800 serif-font flex items-center gap-2"><i class="fa-solid fa-city text-slate-300 text-sm"></i> ${city}</h3>
                        ${isPoll ? '<span class="bg-amber-50 text-amber-700 text-[9px] font-bold px-2 py-1 rounded border border-amber-100">ENQUETE</span>' : '<span class="bg-blue-50 text-blue-700 text-[9px] font-bold px-2 py-1 rounded border border-blue-100">CONFIRMADO</span>'}
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-${list.length > 1 ? '2 lg:grid-cols-3' : '1'} gap-5">
            `;
            
            list.forEach((h, index) => {
                const savedVote = localStorage.getItem(`vote_${city}`);
                const isSelected = savedVote === h.name;
                const imgUrl = `https://image.pollinations.ai/prompt/luxury hotel ${h.img} interior professional photo?width=500&height=350&nologo=true`;
                
                // Simulador de Votos (Totalizador)
                const fakeVotes = (h.name.length * 3) % 20 + 5 + (isSelected ? 1 : 0); 
                const totalCityVotes = 60;
                const percentage = Math.min(100, (fakeVotes / totalCityVotes) * 100);

                html += `
                    <div class="border ${isSelected ? 'border-green-500 ring-2 ring-green-50' : 'border-slate-100'} rounded-xl overflow-hidden flex flex-col h-full bg-white transition-all hover:shadow-md">
                        <div class="h-36 relative overflow-hidden card-zoom">
                            <img src="${imgUrl}" loading="lazy" class="w-full h-full object-cover">
                            <div class="absolute top-2 right-2 bg-black/70 text-white text-[10px] font-bold px-2 py-0.5 rounded backdrop-blur-sm">${h.stars}</div>
                        </div>
                        <div class="p-4 flex flex-col flex-grow">
                            <h4 class="font-bold text-slate-900 text-sm mb-1 leading-snug">${h.name}</h4>
                            <p class="text-[11px] text-slate-500 mb-3 line-clamp-2">${h.desc}</p>
                            
                            <div class="bg-slate-50 p-2.5 rounded-lg mb-3 mt-auto border border-slate-100">
                                <div class="flex justify-between text-[10px] mb-1"><span class="text-slate-400 font-semibold">Datas</span> <span class="font-bold text-slate-600">${h.dates}</span></div>
                                <div class="flex justify-between text-[11px]"><span class="text-slate-400 font-semibold">Total</span> <span class="font-bold text-slate-800">${h.price}</span></div>
                            </div>
                            
                            ${isPoll ? `
                                <div class="mb-3">
                                    <div class="flex justify-between text-[10px] text-slate-500 mb-1">
                                        <span>Votos do Grupo</span>
                                        <span>${fakeVotes}</span>
                                    </div>
                                    <div class="w-full bg-slate-100 rounded-full h-1.5 overflow-hidden">
                                        <div class="bg-amber-400 h-1.5 rounded-full vote-bar" style="width: ${percentage}%"></div>
                                    </div>
                                </div>
                            ` : ''}

                            <div class="grid grid-cols-2 gap-2 mb-2">
                                <a href="https://www.booking.com/searchresults.html?ss=${encodeURIComponent(h.name)}" target="_blank" class="text-center py-2 bg-blue-50 text-blue-600 text-[10px] font-bold rounded-lg hover:bg-blue-100 transition-colors">Booking</a>
                                <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(h.name)}" target="_blank" class="text-center py-2 bg-rose-50 text-rose-600 text-[10px] font-bold rounded-lg hover:bg-rose-100 transition-colors">Mapa</a>
                            </div>
                            
                            ${isPoll ? `<button onclick="vote('${city}', '${h.name}')" class="vote-btn w-full py-2.5 rounded-lg font-bold ${isSelected ? 'selected' : 'bg-slate-800 text-white hover:bg-slate-700'}" ${!isPollOpen ? 'disabled' : ''}>${isSelected ? '<i class="fa-solid fa-check mr-1"></i> Voto Confirmado' : 'Votar nesta Opção'}</button>` : ''}
                        </div>
                    </div>
                `;
            });
            html += `</div></div>`;
            hotelContainer.innerHTML += html;
        }

        window.vote = (city, hotel) => {
            if(!isPollOpen) return;
            localStorage.setItem(`vote_${city}`, hotel);
            location.reload();
        };

        const gastroGrid = document.getElementById('gastronomy-grid');
        gastronomy.forEach(item => {
            const imgUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(item.img)}%20food%20gourmet%20photography?width=500&height=350&nologo=true`;
            gastroGrid.innerHTML += `
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden card-zoom flex flex-col">
                    <div class="h-40 overflow-hidden relative">
                        <img src="${imgUrl}" loading="lazy" class="w-full h-full object-cover">
                        <div class="absolute bottom-0 left-0 w-full h-12 bg-gradient-to-t from-black/60 to-transparent"></div>
                    </div>
                    <div class="p-4 flex-1 relative">
                        <div class="flex justify-between items-start mb-1">
                            <h4 class="font-bold text-slate-800 text-sm">${item.title}</h4>
                            <span class="text-[9px] bg-rose-50 text-rose-700 font-bold px-2 py-0.5 rounded border border-rose-100 uppercase tracking-wide">${item.loc}</span>
                        </div>
                        <p class="text-xs text-slate-500 leading-relaxed">${item.desc}</p>
                    </div>
                </div>
            `;
        });

        const galleryGrid = document.getElementById('gallery-grid');
        const galleryItems = [
            {t: "Torre Eiffel", p: "Paris Eiffel Tower sunset cinematic"}, 
            {t: "Campos de Lavanda", p: "Valensole lavender fields purple sunny"},
            {t: "Calanques", p: "Calanques Cassis blue water aerial"}, 
            {t: "Nice Riviera", p: "Nice Promenade des Anglais beach aerial"},
            {t: "Mônaco", p: "Monaco Monte Carlo luxury cars casino"}, 
            {t: "Palácio dos Papas", p: "Avignon Palais des Papes historical"}
        ];
        if(galleryGrid) {
            galleryItems.forEach(g => {
                galleryGrid.innerHTML += `
                    <div class="relative h-40 rounded-xl overflow-hidden card-zoom shadow-sm group">
                        <img src="https://image.pollinations.ai/prompt/${encodeURIComponent(g.p)}?width=500&height=500&nologo=true" loading="lazy" class="w-full h-full object-cover">
                        <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/80 to-transparent p-3 pt-10">
                            <span class="text-white font-bold text-xs shadow-sm group-hover:text-rose-200 transition-colors tracking-wide">${g.t}</span>
                        </div>
                    </div>
                `;
            });
        }

        new Chart(document.getElementById('themeChart'), {
            type: 'doughnut',
            data: {
                labels: ['Cultura', 'Gastronomia', 'Natureza', 'Lazer'],
                datasets: [{ data: [35, 25, 25, 15], backgroundColor: ['#4f46e5', '#be123c', '#0d9488', '#f59e0b'], borderWidth: 0 }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { boxWidth: 8, font: { size: 10, family: "'Lato', sans-serif" } } } }, layout: { padding: 10 } }
        });

        // 4. INTEGRAÇÃO IA (GEMINI) APROFUNDADA
        async function callGemini(prompt) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`, {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "Erro na IA.";
            } catch (e) { return "Erro de conexão."; }
        }

        const chatInput = document.getElementById('chatInput');
        const chatMsgs = document.getElementById('chatMessages');
        const sendBtn = document.getElementById('sendMessage');

        const handleChat = async () => {
            const text = chatInput.value.trim();
            if(!text) return;
            
            chatMsgs.innerHTML += `<div class="bg-rose-600 text-white p-3 rounded-2xl rounded-tr-none text-xs self-end max-w-[85%] mb-2 shadow-md">${text}</div>`;
            chatInput.value = '';
            chatMsgs.scrollTop = chatMsgs.scrollHeight;
            
            const loader = document.createElement('div');
            loader.className = 'bg-white p-3 rounded-2xl rounded-tl-none border border-slate-100 self-start mb-2 typing-indicator shadow-sm';
            loader.innerHTML = '<span></span><span></span><span></span>';
            chatMsgs.appendChild(loader);

            const prompt = `Você é um concierge de luxo para uma viagem à França (Paris, Provence, Riviera) em Junho de 2026. O usuário pergunta: "${text}". Responda em Português, de forma curta, elegante e útil.`;
            const response = await callGemini(prompt);
            
            chatMsgs.removeChild(loader);
            chatMsgs.innerHTML += `<div class="bg-white p-3 rounded-2xl rounded-tl-none border border-slate-100 text-xs self-start max-w-[85%] text-slate-600 mb-2 shadow-sm leading-relaxed">${response}</div>`;
            chatMsgs.scrollTop = chatMsgs.scrollHeight;
        };

        sendBtn.onclick = handleChat;
        chatInput.onkeypress = (e) => e.key === 'Enter' && handleChat();
        document.getElementById('toggleChat').onclick = () => document.getElementById('chatWindow').classList.toggle('open');
        document.getElementById('closeChat').onclick = () => document.getElementById('chatWindow').classList.remove('open');

        // IA Gastronomia Profunda (Corrigido)
        document.getElementById('decodeMenuBtn').onclick = async () => {
            const dish = document.getElementById('menuInput').value;
            if(!dish) return;
            const res = document.getElementById('menuResult');
            res.classList.remove('hidden');
            res.innerHTML = "<div class='typing-indicator'><span></span><span></span><span></span></div> <span class='text-xs text-slate-400'>O Chef está pesquisando...</span>";
            
            // Prompt ajustado para agir como Sommelier/Chef
            const prompt = `Aja como um chef francês renomado e sommelier. Explique o prato "${dish}" com profundidade e elegância: 1) Breve origem histórica, 2) Ingredientes principais, 3) Perfil de sabor, 4) Sugestão de vinho para harmonizar. Formate com quebras de linha.`;
            
            const response = await callGemini(prompt);
            res.innerHTML = response.replace(/\n/g, '<br>');
        };

        // IA Logística Personalizada (Corrigido)
        document.getElementById('generatePackingBtn').onclick = async () => {
            const profile = document.getElementById('packingProfile').value;
            if(!profile) { alert("Por favor, descreva seu perfil."); return; }
            
            const res = document.getElementById('packingResult');
            res.classList.remove('hidden');
            res.innerHTML = "<div class='typing-indicator'><span></span><span></span><span></span></div> <span class='text-xs text-slate-400'>Personal Stylist trabalhando...</span>";
            
            // Prompt usa o input específico do usuário
            const prompt = `Atue como um Personal Stylist de viagem de luxo. Crie uma lista de mala compacta e inteligente para 16 dias na França em Junho (Paris + Provence + Riviera). O perfil do viajante é: "${profile}". Inclua itens essenciais de vestuário, calçados e acessórios, focando em versatilidade e elegância. Use emojis e bullet points.`;
            
            const response = await callGemini(prompt);
            res.innerHTML = response.replace(/\n/g, '<br>');
        };
    </script>
</body>
</html>
